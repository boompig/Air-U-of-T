<!DOCTYPE html>

<html>
	<head>
		<title>Assignment 2 | CSC309</title>
		<meta charset="UTF-8" />
		
		<!-- JQuery UI stylesheet -->
		<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/excite-bike/jquery-ui.css" />
		
		<!-- libraries in /lib -->
		<script src="lib/jquery-1.10.2.js"></script>
		<script src="lib/jquery-ui.js"></script>
		
		<link rel="stylesheet" href="style.css" />
		
		<script src="verifier.js"></script>
		<script src="flights.js"></script>

		<script>
		function fetchFlights() {
			if ($("#flightList").find("li").length > 0)
				return;
			
			var from = $("#campus").val();
			var when = $("#flightDate").val();
			
			
			
			var r = Flights.fetch(from, when);
			var l;
			
			for (var i = 0; i < r.length; i++) {
				$("#flightList").append("<li>" + r[i].toString() + "</li>");
			}
			
			$("#flightList").selectable();
			
			console.log(r);
		}
		
		$(document).ready(function () {
			// create tabs but disable them - only allow navigation between tabs using JS
			// do not disable current tab
			$("#tabs").tabs({disabled : [1, 2, 3]});
			
			$("#flightDate").datepicker({
				minDate : 1, //tomorrow
				maxDate : 14, // 2 weeks from today
				onSelect : function () {
					var r = Verifier.verifyFlightDate($(this).val());
					//console.log(r);
				}
			});
			
			
			$("#campus").change(function() {
				var r = Verifier.verifyCampus($(this).val());
				//console.log(r);
			});
			
			$("#flightNextButton").click(function() {
				var ok = Verifier.verifyCampus($("#campus").val());
				var ok = ok && Verifier.verifyFlightDate($("#flightDate").val());
				
				if (ok) {
					console.log("ok");
					// enable next tab and switch to it
					$("#tabs").tabs("enable", 1);
					$("#tabs").tabs("option", "active", 1);
				}
			});
			
			$("#flightInfoPanel").tabs({
				show: function () {
					console.log("open sesame");
				}
			});
			
			$("#fetchFlightsButton").click(function() {
				fetchFlights();
			});
		});
		</script>
	</head>

	<body>
		<div id="tabs">
			<ul>
				<li><a href="#startPanel">Find Flights</a></li>
				<li><a href="#flightInfoPanel">Select Flight</a></li>
				<li><a href="#seatInfoPanel">Seat Selection</a></li>
				<li><a href="#billingInfoPanel">Billing Information</a></li>
			</ul>
		
			<div id="startPanel">
				<p>Choose a date of departure and the campus you're departing from to get started</p>
				
				<form>
					<div>
						<select name="campus" id="campus">
							<option value="" disabled="disabled" selected="selected">--Select a Campus--&nbsp;</option>
							<option value="UTSG">St. George</option>
							<option value="UTM">Mississauga</option>
						</select>
						<span id="campusError" class="error"><!-- auto-gen errors go here --></span>
					</div>
					
					<div>
						<label for="flightDate">Departure date: </label>
						<!-- <input type="text" name="flightDate" id="flightDate" readonly="readonly" size="10" /> -->
						<span id="flightDate"><!--auto-gen content --></span>
						<span id="flightDateError" class="error"><!-- auto-gen errors go here --></span>
					</div>
					
					<button type="button" class="nextButton" id="flightNextButton">Next</button>
				</form>
			</div>
		
			<div id="flightInfoPanel" class="panel">
				<h1>Flight Info Panel</h1>
				
				<ul id="flightList">
					<!-- flights are auto-generated here -->
				</ul>
				
				<button type="button" id="fetchFlightsButton">Fetch Flights</button>
				<button type="button" class="nextButton">Next</button>
			</div>
			
			<div id="seatInfoPanel" class="panel">
				<h1>Seat Panel</h1>
				<button type="button" class="nextButton">Next</button>
			</div>
			
			<div id="billingInfoPanel" class="panel">
				<h1>Billing Panel</h1>
			</div>
		</div> <!-- end tabs -->
	</body>
</html>

